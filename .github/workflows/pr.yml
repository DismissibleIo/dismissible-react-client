name: PR - build and test

on:
  pull_request:
    branches:
      - "**"

permissions:
  contents: read

jobs:
  build_test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 24
          cache: npm

      - name: Install
        run: npm ci

      - name: Commitlint (PR commit messages)
        run: >-
          npx --no -- commitlint
          --from "${{ github.event.pull_request.base.sha }}"
          --to "${{ github.event.pull_request.head.sha }}"
          --verbose

      - name: Build
        run: npm run build

      - name: Test
        run: npm test
